<!DOCTYPE html>
<html lang="fa" dir="rtl">
{% load static %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>{% block title %}{% endblock %}</title>

    <!-- üß± Base Styles -->
    <link rel="stylesheet" href="{% static 'css/parent/base.css' %}">
    <link rel="icon" href="{% static 'icons/favicon.ico' %}">

    <!-- üì¶ Block for extra page-specific styles -->
    {% block extra_css %}{% endblock %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <!-- ‚úÖ PWA Manifest -->
    <link rel="manifest" href="{% static 'main/manifest.json' %}">
    <meta name="theme-color" content="#d4af37">

    <!-- ‚úÖ PWA Icons -->
    <link rel="apple-touch-icon" sizes="192x192" href="{% static 'icons/icon-192x192.png' %}">
    <link rel="apple-touch-icon" sizes="512x512" href="{% static 'icons/icon-512x512.png' %}">

    <!-- ‚úÖ Display standalone mode -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ŸÖÿ≥ÿ¨ÿØ ÿ±ÿ∂Ÿà€åŸá ÿßŸÅÿ≥ÿ±€åŸá">

</head>

<body data-auth="{{ request.user.is_authenticated|yesno:'true,false' }} " data-theme="dark">
<!-- üïå Header (optional include later) -->
{% include 'partials/header.html' %}

<!-- üìú Main content -->
<main class="container">
    {% block body %}{% endblock %}
</main>

<!-- ü¶∂ Footer -->
{% include 'partials/footer.html' %}

<!-- üîß Page-specific scripts -->
{% block scripts %}

{% endblock %}
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const menuToggle = document.getElementById("menuToggle");
        const navMenu = document.querySelector(".nav-menu");

        menuToggle.addEventListener("click", () => {
            navMenu.classList.toggle("active");
            menuToggle.classList.toggle("open");
            menuToggle.innerHTML = menuToggle.classList.contains("open")
                ? '<i class="fas fa-times"></i>'
                : '<i class="fas fa-bars"></i>';
        });
    });
</script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const icons = document.querySelectorAll(".social-icons img");

        function updateIconsForTheme(theme) {
            icons.forEach(icon => {
                const lightSrc = icon.getAttribute("data-light");
                const darkSrc = icon.getAttribute("data-dark");

                if (theme === "dark") {
                    icon.src = darkSrc;
                } else {
                    icon.src = lightSrc;
                }
            });
        }

        // ÿß⁄Øÿ± ÿ≥ÿß€åÿ™ÿ™ ÿ®ÿß data-theme ÿ±Ÿà€å body ⁄©ÿßÿ± ŸÖ€å‚Äå⁄©ŸÜŸá:
        const observer = new MutationObserver(() => {
            const theme = document.body.getAttribute("data-theme") || "light";
            updateIconsForTheme(theme);
        });

        observer.observe(document.body, {attributes: true, attributeFilter: ["data-theme"]});

        // ÿßÿ¨ÿ±ÿß€å ÿßŸàŸÑ€åŸá ŸáŸÜ⁄ØÿßŸÖ ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ÿµŸÅÿ≠Ÿá
        const initialTheme = document.body.getAttribute("data-theme") || "light";
        updateIconsForTheme(initialTheme);
    });
</script>
<!-- ‚úÖ Service Worker Registration -->
<script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', function () {
            navigator.serviceWorker.register("{% static 'main/js/service-worker.js' %}")
                .then(function (registration) {
                    console.log('Service Worker registered with scope:', registration.scope);
                })
                .catch(function (error) {
                    console.log('Service Worker registration failed:', error);
                });
        });
    }
</script>
</body>
</html>