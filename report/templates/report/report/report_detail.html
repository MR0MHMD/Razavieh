{% extends 'parent/base.html' %}
{% load static %}
{% load jformat %}
{% load report_tags %}
{% block title %}{{ report.title }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'report/css/report/report_detail.css' %}">
{% endblock %}

{% block body %}
<div class="report-detail-container container">

    <!-- عنوان و اطلاعات -->
    <header class="report-header">
        <h1 class="report-title">{{ report.title }}</h1>
        <div class="report-meta">
            <span class="report-date">{{ report.date|jformat:"%Y/%m/%d" }}</span>
            <button class="like-btn large" data-report-id="{{ report.id }}">
                ❤️ <span class="like-count">{{ report.likes.count }}</span>
            </button>
        </div>
    </header>

    <!-- گالری تصاویر -->
    {% if report.images.all %}
    <section class="report-gallery">
        {% for image in report.images.all %}
        <div class="gallery-item">
            <img src="{{ image.image.url }}" alt="{{ report.title }}">
        </div>
        {% endfor %}
    </section>
    {% endif %}

    <!-- متن گزارش -->
    <article class="report-content card">
        {{ report.description|linebreaks }}
    </article>

    <!-- بخش نظرات -->
    <!-- بخش نظرات -->
    <section class="comments-section">
        <h2>نظرات</h2>
    
        <!-- فرم ثبت نظر -->
        <a href="{% url 'report:report_comment' report.slug %}" class="btn btn-primary">ارسال نظر</a>
        {% latest_comments 3 %}
    
        {% if report.comments.count > 3 %}
            <div class="more-comments">
                <a href="{% url 'report:report_comment_list' report.slug %}">مشاهده تمام کامنت‌ها</a>
            </div>
        {% endif %}
    </section>
</div>

<!-- Lightbox -->
<div id="lightbox" class="lightbox">
    <span class="close">&times;</span>
    <img class="lightbox-img" src="" alt="">
</div>

{% endblock %}
{% block scripts %}
	<script src="{% static 'report/js/lightbox.js' %}"></script>
    <script src="{% static 'report/js/comment_react.js' %}"></script>
{% endblock %}
