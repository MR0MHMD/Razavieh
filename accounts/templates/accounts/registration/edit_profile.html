{% extends 'parent/base.html' %}
{% load static %}

{% block title %}ویرایش پروفایل{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/parent/forms.css' %}">
{% endblock %}

{% block body %}
    <section class="form-page fade-up">
        <h1 class="form-title">ویرایش اطلاعات کاربری</h1>
        <form method="post" enctype="multipart/form-data" class="form-container edit-form">
            {% csrf_token %}
            <fieldset class="form-section">
                <legend>عکس پروفایل</legend>
                <div class="avatar-row">
                    <div class="current-avatar">
                        {% if user.photo %}
                            <img id="avatar-preview" src="{{ user.photo.url }}" alt="{{ user.username }}"
                                 class="avatar-img">
                            <button type="button" id="remove-photo-btn" class="btn btn-outline small-btn">حذف عکس
                            </button>
                        {% else %}
                            <img id="avatar-preview" src="{% static 'default.png' %}" alt="بدون تصویر"
                                 class="avatar-img">
                        {% endif %}
                    </div>
                    <div class="photo-input">
                        <label for="{{ form.photo.id_for_label }}" class="form-label">تغییر عکس پروفایل</label>
                        {{ form.photo }}
                        {% if form.photo.errors %}
                            <div class="field-errors">
                                {% for error in form.photo.errors %}
                                    <p class="error-text">{{ error }}</p>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                </div>
            </fieldset>
            <fieldset class="form-section">
                <legend>اطلاعات کاربری</legend>
                <div class="form-group">
                    {{ form.first_name.label_tag }}
                    {{ form.first_name }}
                    {% for error in form.first_name.errors %}
                        <p class="error-text">{{ error }}</p>
                    {% endfor %}
                </div>
                <div class="form-group">
                    {{ form.last_name.label_tag }}
                    {{ form.last_name }}
                    {% for error in form.last_name.errors %}
                        <p class="error-text">{{ error }}</p>
                    {% endfor %}
                </div>
                <div class="form-group">
                    {{ form.email.label_tag }}
                    {{ form.email }}
                    {% for error in form.email.errors %}
                        <p class="error-text">{{ error }}</p>
                    {% endfor %}
                </div>
            </fieldset>
            <div class="form-actions">
                <button type="submit" class="btn btn-primary full-width-btn">ذخیره تغییرات</button>
                <a href="{% url 'accounts:profile' %}" class="btn btn-outline">بازگشت</a>
            </div>
        </form>
    </section>
{% endblock %}

{% block scripts %}
    <script src="{% static 'accounts/js/edit_profile.js' %}"></script>
    <script src="{% static 'js/upload-file.js' %}"></script>
{% endblock %}